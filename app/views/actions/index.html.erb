<div class="banner">
  <div class="container">
    <h1 class='text-center fonts-title'><strong>Faites votre choix!</strong></h1>

  </div>
</div>
<p> <h2 class=" text-center">Categories disponibles</h2> </p>
<%= form_tag(actions_path, method: :get, data: { controller: "hello" }, class: "category_form") do %>
  <div class="row d-flex justify-content-center">
        <% @all_user_categories.each do |category| %>
          <% color = category.category_color %>
          <div class=" row text-center custom-checkbox btn-categories" style="--category_checkbox:<%= category.category_color %> ;">
            <%= label_tag "category_#{category.id}", category.title, class: "category_checkbox" %>
            <%= check_box_tag 'categories[]', category.id, @selected_category_ids.include?(category.id) %>
          </div>
        <% end %>
        <div class="d-flex justify-content-center">
          <%= submit_tag 'Filtrer', class:'btn btn-outline-dark categories fonts-text' %>
        </div>
  </div>


<% end %>

  <!-- Content you want to update -->
  <%= render "categories" %>

<%# <h2 class=" text-center">Categories disponibles</h2>
<%= form_tag(actions_path, method: :get, data: { controller: "hello" }, class: "category_form") do %>
  <%# <div class="row d-flex justify-content-center"> %>
    <%# <% @all_user_categories.each do |category| %>
      <%# <% color = category.id % Category::COLORS.length %>
      <%# <div class="custom-checkbox" style="--category_checkbox:<%= Category::COLORS[color] %>
        <%# <%= label_tag "category_#{category.id}", category.title, class: "category_checkbox" %>
        <%# <%= check_box_tag 'categories[]', category.id, @selected_category_ids.include?(category.id) %>
      <%# </div> %>
    <%# <% end %>
  <%# </div> %>
  <%# <%= submit_tag 'Filtrer' %>
<%# <% end %>

<%#
<script>

  document.addEventListener("DOMContentLoaded", function() {
    const checkboxes = document.querySelectorAll('.category_checkbox');

    checkboxes.forEach(checkbox => {
      const box = checkbox.nextElementSibling;

      if (box) { // Vérifier si la checkbox existe avant d'ajouter les écouteurs
        function updateCheckboxColor() {
          if (box.checked) {
            checkbox.style.backgroundColor = "var(--category_checkbox)";
          } else {
            checkbox.style.backgroundColor = "initial";
          }
        }
  console.log(box);
        box.addEventListener('click', (event) => {
          updateCheckboxColor();
          event.currenTarget.checked = !event.currentTarget.checked;
          console.log(event.currentTarget);
        });

        updateCheckboxColor();
      }
    });

    const filterButton = document.querySelector('.category_form input[type="submit"]');

    if (filterButton) { // Vérifier si le bouton existe avant d'ajouter l'écouteur
      filterButton.addEventListener('click', function() {
        // Logique pour la soumission du formulaire ou AJAX si nécessaire
      });
    }
  });
</script> %>
