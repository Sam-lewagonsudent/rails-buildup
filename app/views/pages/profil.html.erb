
      <div class="d-flex flex-column align-items-center user-header">

        <div class="d-flex align-items-left">
          <h2 class="mr-3"><%= current_user.user_name %></h2>

          <% if current_user.selected_icon.present? %>
            <div class="selected-icon">
              <%= image_tag("achievements/#{current_user.selected_icon}", alt: "Selected Icon", width: 50, height: 50, class: "img-fluid") %>
            </div>
          <% end %>
        </div>
      </div>
      <div class="border-top">
        <%= link_to "Achievements", achievements_path, class:'btn ' %>
    <br>
       <%= link_to "Log out",  destroy_user_session_path,data: {turbo_method: :delete}, class:'btn ' %>
      </div>
  <div class="col-md-4">
    <div class="accordion custom-card-uc align-items-start" id="accordionPanelsStayOpenprofil1">
      <div class="accordion-item">
            <h2 class="accordion-header fonts-title" id="panelsStayOpen-headingTwo-profil-1">
            <button class="accordion-button " type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseTwo-1" aria-expanded="false" aria-controls="panelsStayOpen-collapseTwo-1">
                Mes categories selectionnées
              </button>
            </h2>
                <div id="panelsStayOpen-collapseTwo-1" class="accordion-collapse collapse" aria-labelledby="panelsStayOpen-headingTwo-1">
                  <div class="accordion-body row justify-content-center">
                    <div class="card-body text-center d-flex justify-content-start">
                          <ul>
                          <% @user_categories.each do |user_category|%>
                        <li>
                        <div class="custom-card text-center" style="background color:<%= user_category.category.category_color %>">
                            <div class="categories fonts-text" >
                              <%= user_category.category.title %>
                            </div>
                        </div>
                        </li>
                          <%end%>
                        <li>
                        <div class="custom-card text-center fonts-text">
                          <%= link_to "Ajuster mes categories", edit_user_category_path, class:"btn btn-custom categories " %>
                        </div>
                        </li>
                        </ul>
                    </div>
                  </div>
                </div>
      </div>
    </div>
  </div>


<h2>Challenges terminés</h2>
<div class="completed-challenges-list">
  <% completed_challenge_counts = Hash.new(0) %>
  <% completed_categories = Set.new %>
  <% @user_challenges.select { |uc| uc.done }.each do |completed_challenge| %>
    <% challenge_name = completed_challenge.action.name %>
    <% completed_challenge_counts[challenge_name] += 1 %>
    <% completed_categories.add(completed_challenge.action.category.title.downcase.gsub(' ', '_')) %>
  <% end %>

  <div class="accordion custom-card-uc" id="accordionPanelsStayOpenExample1">
    <% completed_categories.each do |category| %>
      <div class="accordion-item">
        <% category_display = category.gsub('_', ' ').titleize %>
        <h3 class="accordion-header  fonts-title" id="panelsStayOpen-headingOne-<%= category %>">
          <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseOne-<%= category %>" aria-expanded="false" aria-controls="panelsStayOpen-collapseOne-<%= category %>">
            <%= category_display %>
          </button>
        </h3>
        <div id="panelsStayOpen-collapseOne-<%= category %>" class="accordion-collapse collapse" aria-labelledby="panelsStayOpen-headingOne-<%= category %>" data-bs-parent="#accordionPanelsStayOpenExample1">
          <div class="accordion-body">
            <div class="card-body text-center d-flex justify-content-start">
              <ul>
                <% @user_challenges.select { |uc| uc.done && uc.action.category.title.downcase.gsub(' ', '_') == category }.each do |completed_challenge| %>
                  <% challenge_name = completed_challenge.action.name %>
                  <% if completed_challenge_counts[challenge_name] > 0 %>
                    <li><%= "#{challenge_name} (Completed #{completed_challenge_counts[challenge_name]} times)" %></li>
                    <% completed_challenge_counts[challenge_name] = 0 %>
                  <% end %>
                <% end %>
              </ul>
            </div>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>
